# 聚雍宝 - 智能客服助手

一个功能强大的客服话术管理和自动发送工具，支持多级分类管理、云端同步、数据导入导出等功能。

## 🌟 主要特性

- **📝 话术管理**: 支持三级分类管理（公司话术/小组话术/私人话术 → 二级分类 → 话术分类）
- **🚀 智能发送**: 多种发送模式（直接发送/添加到输入框/复制到剪贴板）
- **🎯 窗口跟踪**: 自动检测目标窗口，支持窗口锁定功能
- **☁️ 云端同步**: 用户登录后可同步话术数据到云端
- **📊 数据管理**: 支持Excel、CSV、JSON格式的数据导入导出
- **🔍 智能搜索**: 全局话术搜索功能
- **⚙️ 个性化设置**: 窗口置顶、发送模式等可自定义配置

## 📋 系统要求

- **操作系统**: Windows 10/11
- **Python版本**: Python 3.7+
- **依赖库**: 
  - tkinter (GUI界面)
  - pyautogui (自动化操作)
  - pyperclip (剪贴板操作)
  - pywin32 (Windows API)
  - requests (网络请求)

## 🚀 快速开始

### 方法一：使用批处理文件（推荐）

1. **安装依赖**
   ```bash
   # 双击运行
   install.bat
   ```

2. **启动程序**
   ```bash
   # 双击运行
   run.bat
   ```

### 方法二：手动安装

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd chatAssistant
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **启动程序**
   ```bash
   python chatAssistant.py
   ```

## 📁 项目结构

```
chatAssistant/
├── chatAssistant.py          # 主程序文件
├── api_manager.py            # API管理模块
├── data_adapter.py           # 数据适配器
├── utils.py                  # 工具函数
├── config.json               # 配置文件
├── scripts.json              # 话术数据文件
├── requirements.txt          # 依赖包列表
├── install.bat               # 安装脚本
├── run.bat                   # 启动脚本
├── components/               # 组件目录
│   ├── Login_dialog.py       # 登录对话框
│   └── Input_dialog.py       # 输入对话框
└── README.md                 # 项目说明文档
```

## 🎮 使用指南

### 基本操作

1. **添加话术分类**
   - 点击"+"按钮添加一级或二级分类
   - 右键分类可进行重命名或删除操作

2. **管理话术内容**
   - 点击"添加话术标题"创建新的话术分类
   - 右键话术分类可添加具体话术内容
   - 双击话术即可发送到目标窗口

3. **发送模式设置**
   - **直接发送**: 自动粘贴并按回车发送
   - **添加到输入框**: 只粘贴到输入框，不自动发送
   - **添加到剪贴板**: 复制到剪贴板，手动粘贴

### 高级功能

#### 窗口管理
- **自动检测**: 程序会自动检测当前活动窗口作为发送目标
- **窗口锁定**: 勾选"锁定"可固定发送目标窗口
- **窗口置顶**: 勾选"置顶"保持程序窗口始终在最前

#### 用户系统
- **登录功能**: 点击"登录"按钮进行用户认证
- **云端同步**: 登录后可上传/下载话术数据
- **多用户支持**: 不同用户拥有独立的话术数据

#### 数据管理
- **导入数据**: 支持从Excel、CSV、JSON文件导入话术
- **导出数据**: 可将话术数据导出为多种格式
- **搜索功能**: 支持跨所有分类的全局话术搜索

## ⚙️ 配置说明

### config.json 配置文件
```json
{
  "send_mode": "直接发送",           // 发送模式
  "always_on_top": true,            // 窗口置顶
  "current_user_id": null,          // 当前用户ID
  "is_logged_in": false             // 登录状态
}
```

### scripts.json 话术数据结构
```json
{
  "公司话术": {
    "常用": {
      "问候语": [
        "您好，很高兴为您服务！",
        "欢迎咨询，请问有什么可以帮助您的吗？"
      ],
      "结束语": [
        "感谢您的咨询，祝您生活愉快！"
      ]
    }
  }
}
```

## 🔧 API 接口

项目支持云端数据同步，需要配合后端API服务使用：

### 主要接口
- `GET /api/user/{user_id}/data` - 获取用户数据
- `PUT /api/user/{user_id}/data` - 保存用户数据
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/logout` - 用户登出
- `POST /api/file/upload-convert` - 文件上传转换
- `POST /api/file/export-convert` - 数据导出转换

## 🛠️ 开发说明

### 核心模块

1. **AssistantOptimized** (chatAssistant.py)
   - 主程序类，负责GUI界面和核心逻辑

2. **APIManager** (api_manager.py)
   - 处理与后端API的通信

3. **DataAdapter** (data_adapter.py)
   - 数据适配器，管理本地和云端数据同步

4. **组件模块** (components/)
   - 可复用的UI组件

### 扩展开发

- 添加新的发送模式
- 扩展话术数据结构
- 集成更多第三方服务
- 添加快捷键支持

## 🐛 常见问题

### Q: 程序无法启动？
A: 请确保已安装Python 3.7+和所有依赖包，可运行`install.bat`重新安装依赖。

### Q: 无法检测到目标窗口？
A: 确保目标应用程序已打开并处于活动状态，程序会自动检测焦点窗口。

### Q: 话术发送失败？
A: 检查发送模式设置，确保目标窗口支持Ctrl+V粘贴操作。

### Q: 云端同步失败？
A: 确保网络连接正常，后端API服务可用，并已正确登录。

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来帮助改进项目！

## 📞 联系方式

如有问题或建议，请通过以下方式联系：

- 提交 GitHub Issue
- 发送邮件至项目维护者

---

**聚雍宝** - 让客服工作更高效！ 🚀